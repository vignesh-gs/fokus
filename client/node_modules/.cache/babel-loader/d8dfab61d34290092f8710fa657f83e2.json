{"ast":null,"code":"import { CURRENT_VERSION } from \"./../helpers/constants\";\nexport function getFokusVersion() {\n  try {\n    return localStorage.getItem(\"version\");\n  } catch (e) {\n    console.error(e.message);\n  }\n}\nexport function setFokusVersion(version) {\n  try {\n    localStorage.setItem(\"version\", version);\n  } catch (e) {\n    console.error(e.message);\n  }\n}\nexport function getStateFromLocalStorage() {\n  try {\n    let serializedState = localStorage.getItem(\"state\");\n    if (serializedState === null) return undefined;\n    let state = JSON.parse(serializedState);\n\n    // values to be reset on refresh\n    if (state !== undefined) {\n      if (state.tasks.meta.focussedTaskIndex !== -1) {\n        state.tasks.taskArray[state.tasks.meta.focussedTaskIndex].isRunning = false;\n        state.tasks.meta.focussedTaskIndex = -1;\n      }\n      state.tasks.soundscape.isPlaying = false;\n    }\n    // values to be reset on refresh\n\n    return state;\n  } catch (e) {\n    console.error(e.message);\n    return undefined;\n  }\n}\nexport function setStateInLocalStorage(state) {\n  try {\n    let serializedState = JSON.stringify(state);\n    localStorage.setItem(\"state\", serializedState);\n  } catch (e) {\n    console.log(\"There was some error in persisting the state. Maybe you're in incognito/private window.\");\n    console.error(e.message);\n  }\n}\nexport function clearStateFromLocalStorage() {\n  try {\n    if (localStorage.getItem(\"state\") !== null) localStorage.removeItem(\"state\");\n  } catch (e) {\n    console.error(e.message);\n  }\n}\nexport function shouldClearStateFromLocalStorage(currentVersion) {\n  try {\n    let version = localStorage.getItem(\"version\");\n    if (version === null) {\n      return true;\n    }\n    version = parseInt(version);\n    if (currentVersion > version) return true;else return false;\n  } catch (e) {\n    console.error(e.message);\n  }\n}\nexport function clearIfStateInvalidated() {\n  if (shouldClearStateFromLocalStorage(CURRENT_VERSION)) {\n    clearStateFromLocalStorage();\n    setFokusVersion(CURRENT_VERSION);\n  }\n}","map":{"version":3,"names":["CURRENT_VERSION","getFokusVersion","localStorage","getItem","e","console","error","message","setFokusVersion","version","setItem","getStateFromLocalStorage","serializedState","undefined","state","JSON","parse","tasks","meta","focussedTaskIndex","taskArray","isRunning","soundscape","isPlaying","setStateInLocalStorage","stringify","log","clearStateFromLocalStorage","removeItem","shouldClearStateFromLocalStorage","currentVersion","parseInt","clearIfStateInvalidated"],"sources":["/Users/vigneshgs/fokus/src/store/localStorageUtils.js"],"sourcesContent":["import { CURRENT_VERSION } from \"./../helpers/constants\";\n\nexport function getFokusVersion() {\n    try {\n        return localStorage.getItem(\"version\");\n    } catch (e) {\n        console.error(e.message);\n    }\n}\n\nexport function setFokusVersion(version) {\n    try {\n        localStorage.setItem(\"version\", version);\n    } catch (e) {\n        console.error(e.message);\n    }\n}\n\nexport function getStateFromLocalStorage() {\n    try {\n        let serializedState = localStorage.getItem(\"state\");\n        if (serializedState === null) return undefined;\n        let state = JSON.parse(serializedState);\n\n        // values to be reset on refresh\n        if (state !== undefined) {\n            if (state.tasks.meta.focussedTaskIndex !== -1) {\n                state.tasks.taskArray[state.tasks.meta.focussedTaskIndex].isRunning = false;\n                state.tasks.meta.focussedTaskIndex = -1;\n            }\n            state.tasks.soundscape.isPlaying = false;\n        }\n        // values to be reset on refresh\n\n        return state;\n    } catch (e) {\n        console.error(e.message);\n        return undefined;\n    }\n}\n\nexport function setStateInLocalStorage(state) {\n    try {\n        let serializedState = JSON.stringify(state);\n        localStorage.setItem(\"state\", serializedState);\n    } catch (e) {\n        console.log(\"There was some error in persisting the state. Maybe you're in incognito/private window.\");\n        console.error(e.message);\n    }\n}\n\nexport function clearStateFromLocalStorage() {\n    try {\n        if (localStorage.getItem(\"state\") !== null) localStorage.removeItem(\"state\");\n    } catch (e) {\n        console.error(e.message);\n    }\n}\n\nexport function shouldClearStateFromLocalStorage(currentVersion) {\n    try {\n        let version = localStorage.getItem(\"version\");\n        if (version === null) {\n            return true;\n        }\n        version = parseInt(version);\n        if (currentVersion > version) return true;\n        else return false;\n    } catch (e) {\n        console.error(e.message);\n    }\n}\n\nexport function clearIfStateInvalidated() {\n    if (shouldClearStateFromLocalStorage(CURRENT_VERSION)) {\n        clearStateFromLocalStorage();\n        setFokusVersion(CURRENT_VERSION);\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}